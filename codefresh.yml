version: '1.0'

steps:
  unit-test-step:
    image: node:latest
    working-directory: ${{initial-clone}}
    commands:
        - npm install
        - npm test
  edit-step:
    image: node:latest
    working-directory: ${{initial-clone}}
    commands:
        - echo "your text" >> package.json
  build-step:
    type: build
    image-name: shaycf/express
  amazon-beanstalk:
    image: garland/aws-cli-docker:latest
    commands:
        - aws elasticbeanstalk update-environment --environment-name shayTest-env --version-label Dockerrun.aws.shaytest29
        - aws configure set aws_access_key_id
        - aws configure set aws_secret_access_key
        - aws configure set region us-east-1
        - aws elasticbeanstalk update-environment --environment-name shayTest-env --version-label Dockerrun.aws.shaytest29
  push to registry:
    type: push
    candidate: ${{build-step}}
    tag: latest
